Ported by Steve Hamblett <steve.hamblett@linux.com> from the original NMQTT implementation by
Mark Allanson <mark@markallanson.net> & Contributors
